import{_ as W,r as C,c as v,w as F,g as o,d as n,h as m,i as r,k as I,m as X,v as Y,e as Z,t as g,F as w,p as P,n as b,j as ee,q as te}from"./application-DdgAEZO5.js";import se from"./BaseSpinner-BJf5kn1B.js";import"/img/ggsheet.png";const ae={class:"base-table-wrapper"},le={key:0,class:"table-header mb-3"},oe={class:"row"},ne={class:"col-md-6"},re={key:0,class:"col-md-6"},ue={class:"form-group mb-0"},ce=["placeholder"],ie={key:1,class:"text-center py-5"},de={class:"mt-2 text-muted"},ve={key:2,class:"text-center py-5"},ye={class:"text-muted"},he={key:3,class:"table-responsive"},pe={key:0,class:"selection-column"},fe=["checked","indeterminate"],ge=["onClick"],me={class:"d-flex align-items-center"},be={key:0,class:"sort-icon ms-1"},ke={key:0,class:"fas fa-sort-down"},_e={key:1,class:"fas fa-sort-up"},Ce={key:2,class:"fas fa-sort text-muted opacity-50"},Be=["onClick"],xe={key:0,class:"selection-column"},Se=["checked","onChange"],we={key:4,class:"d-flex justify-content-between align-items-center mt-3"},Pe={class:"text-muted"},Ne={"aria-label":"Table pagination"},Me={class:"pagination mb-0"},$e=["disabled"],De=["onClick"],Fe=["disabled"],Ie={__name:"BaseTable",props:{items:{type:Array,required:!0},fields:{type:Array,required:!0},loading:{type:Boolean,default:!1},busy:{type:Boolean,default:!1},striped:{type:Boolean,default:!0},bordered:{type:Boolean,default:!1},hover:{type:Boolean,default:!0},small:{type:Boolean,default:!1},fixed:{type:Boolean,default:!1},responsive:{type:Boolean,default:!0},selectable:{type:Boolean,default:!1},selectMode:{type:String,default:"multi",validator:c=>["single","multi","range"].includes(c)},searchable:{type:Boolean,default:!1},searchPlaceholder:{type:String,default:"検索..."},searchFields:{type:Array,default:()=>[]},paginate:{type:Boolean,default:!0},perPage:{type:Number,default:20},paginationLimit:{type:Number,default:5},sortBy:{type:String,default:null},sortDesc:{type:Boolean,default:!1},emptyText:{type:String,default:"データがありません"},loadingText:{type:String,default:"読み込み中..."}},emits:["search","row-selected","row-clicked","sort-changed","update:sortBy","update:sortDesc","page-change"],setup(c,{expose:O,emit:R}){const a=c,h=R,k=C(""),i=C(1),y=C(a.sortBy),p=C(a.sortDesc),d=C([]),N=v(()=>a.fields.map(e=>typeof e=="string"?{key:e,label:e,sortable:!0}:{key:e.key,label:e.label||e.key,sortable:e.sortable!==!1,thClass:e.thClass||"",tdClass:e.tdClass||"",formatter:e.formatter})),A=v(()=>({"table-striped":a.striped,"table-bordered":a.bordered,"table-hover":a.hover,"table-sm":a.small})),T=v(()=>{if(!a.searchable||!k.value)return a.items;const e=k.value.toLowerCase(),s=a.searchFields.length?a.searchFields:N.value.map(t=>t.key);return a.items.filter(t=>s.some(u=>{const l=S(t,u);return l&&l.toString().toLowerCase().includes(e)}))}),M=v(()=>{if(!y.value)return T.value;const e=[...T.value].sort((s,t)=>{const u=S(s,y.value),l=S(t,y.value);return u===l?0:u==null?1:l==null?-1:typeof u=="string"?u.localeCompare(l):u<l?-1:1});return p.value?e.reverse():e}),B=v(()=>M.value.length),x=v(()=>Math.ceil(B.value/a.perPage)),f=v(()=>{if(!a.paginate)return M.value;const e=(i.value-1)*a.perPage,s=e+a.perPage;return M.value.slice(e,s)}),V=v(()=>{const e=(i.value-1)*a.perPage+1,s=Math.min(i.value*a.perPage,B.value);return{from:e,to:s}}),q=v(()=>{const e=[],s=Math.floor(a.paginationLimit/2);let t=Math.max(1,i.value-s),u=Math.min(x.value,t+a.paginationLimit-1);u-t<a.paginationLimit-1&&(t=Math.max(1,u-a.paginationLimit+1));for(let l=t;l<=u;l++)e.push(l);return e}),$=v(()=>f.value.length>0&&f.value.every(e=>_(e))),E=v(()=>d.value.length>0&&!$.value),S=(e,s)=>s.split(".").reduce((t,u)=>t==null?void 0:t[u],e),L=(e,s)=>S(e,s.key),j=(e,s)=>{const t=L(e,s);return s.formatter?s.formatter(t,s.key,e):t??""},z=e=>({[e.thClass]:e.thClass,sortable:e.sortable,"cursor-pointer":e.sortable}),H=e=>e.tdClass||"",Q=e=>{e.sortable&&(y.value===e.key?p.value=!p.value:(y.value=e.key,p.value=!1),h("sort-changed",{sortBy:y.value,sortDesc:p.value}),h("update:sortBy",y.value),h("update:sortDesc",p.value))},U=()=>{i.value=1,h("search",k.value)},_=e=>d.value.some(s=>JSON.stringify(s)===JSON.stringify(e)),J=e=>{if(a.selectMode==="single")d.value=_(e)?[]:[e];else{const s=d.value.findIndex(t=>JSON.stringify(t)===JSON.stringify(e));s>-1?d.value.splice(s,1):d.value.push(e)}h("row-selected",d.value)},G=()=>{$.value?f.value.forEach(e=>{const s=d.value.findIndex(t=>JSON.stringify(t)===JSON.stringify(e));s>-1&&d.value.splice(s,1)}):f.value.forEach(e=>{_(e)||d.value.push(e)}),h("row-selected",d.value)},K=(e,s,t)=>{h("row-clicked",e,s,t)},D=e=>{e<1||e>x.value||(i.value=e,h("page-change",e))};return F(()=>a.sortBy,e=>{y.value=e}),F(()=>a.sortDesc,e=>{p.value=e}),F(k,()=>{i.value=1}),O({clearSelection:()=>{d.value=[],h("row-selected",[])},selectRow:e=>{e>=0&&e<f.value.length&&J(f.value[e])}}),(e,s)=>(n(),o("div",ae,[e.$slots.actions||c.searchable?(n(),o("div",le,[r("div",oe,[r("div",ne,[I(e.$slots,"actions",{},void 0,!0)]),c.searchable?(n(),o("div",re,[r("div",ue,[X(r("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>k.value=t),type:"text",class:"form-control",placeholder:c.searchPlaceholder,onInput:U},null,40,ce),[[Y,k.value]])])])):m("",!0)])])):m("",!0),c.loading?(n(),o("div",ie,[Z(se,{variant:"primary"}),r("p",de,g(c.loadingText),1)])):f.value.length?(n(),o("div",he,[r("table",{class:b(["table",A.value])},[r("thead",null,[r("tr",null,[c.selectable?(n(),o("th",pe,[c.selectMode==="multi"?(n(),o("input",{key:0,type:"checkbox",class:"form-check-input",checked:$.value,indeterminate:E.value,onChange:G},null,40,fe)):m("",!0)])):m("",!0),(n(!0),o(w,null,P(N.value,t=>(n(),o("th",{key:t.key,class:b(z(t)),onClick:u=>Q(t)},[r("div",me,[r("span",null,g(t.label),1),t.sortable?(n(),o("span",be,[y.value===t.key&&p.value?(n(),o("i",ke)):y.value===t.key&&!p.value?(n(),o("i",_e)):(n(),o("i",Ce))])):m("",!0)])],10,ge))),128))])]),r("tbody",null,[(n(!0),o(w,null,P(f.value,(t,u)=>(n(),o("tr",{key:t.id||u,class:b({"table-active":_(t)}),onClick:l=>K(t,u,l)},[c.selectable?(n(),o("td",xe,[r("input",{type:"checkbox",class:"form-check-input",checked:_(t),onClick:s[1]||(s[1]=ee(()=>{},["stop"])),onChange:l=>J(t)},null,40,Se)])):m("",!0),(n(!0),o(w,null,P(N.value,l=>(n(),o("td",{key:l.key,class:b(H(l))},[I(e.$slots,`cell(${l.key})`,{value:L(t,l),item:t,field:l},()=>[te(g(j(t,l)),1)],!0)],2))),128))],10,Be))),128))])],2)])):(n(),o("div",ve,[I(e.$slots,"empty",{},()=>[s[4]||(s[4]=r("i",{class:"fas fa-inbox fa-3x text-muted mb-3"},null,-1)),r("p",ye,g(c.emptyText),1)],!0)])),c.paginate&&B.value>c.perPage?(n(),o("div",we,[r("div",Pe," 表示 "+g(V.value.from)+" - "+g(V.value.to)+" / 全 "+g(B.value)+" 件 ",1),r("nav",Ne,[r("ul",Me,[r("li",{class:b(["page-item",{disabled:i.value===1}])},[r("button",{class:"page-link",onClick:s[2]||(s[2]=t=>D(i.value-1)),disabled:i.value===1}," 前へ ",8,$e)],2),(n(!0),o(w,null,P(q.value,t=>(n(),o("li",{key:t,class:b(["page-item",{active:t===i.value}])},[r("button",{class:"page-link",onClick:u=>D(t)},g(t),9,De)],2))),128)),r("li",{class:b(["page-item",{disabled:i.value===x.value}])},[r("button",{class:"page-link",onClick:s[3]||(s[3]=t=>D(i.value+1)),disabled:i.value===x.value}," 次へ ",8,Fe)],2)])])])):m("",!0)]))}},Je=W(Ie,[["__scopeId","data-v-4083128c"]]);export{Je as default};
//# sourceMappingURL=BaseTable-BwpU3Zct.js.map
